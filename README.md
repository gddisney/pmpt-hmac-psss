# pmpt-hmac-psss
---

# **PMPT: Probabilistic Modular Point Transformation**

## **Overview**
PMPT (Probabilistic Modular Point Transformation) is a novel cryptographic system that combines:

- **Shamir's Secret Sharing (PSSS)** for secure threshold-based secrets.
- **3D Quadratic Space** for unique point-based encryption and validation.
- **Dynamic Probabilistic Transformations** with Gaussian noise and secure S-Box substitution.
- **PMPT-HMAC** for probabilistic signature generation and verification.

PMPT fundamentally enhances cryptographic security by introducing **probabilistic, modular, and spatially unique transformations** while maintaining verifiability and robustness.

---

## **Key Features**
- **3D Quadratic Mapping**: Messages are mapped to a 3D point structure, creating a unique spatial representation.
- **Dynamic S-Box Substitution**: Secure dynamic S-Boxes obfuscate data during transformation.
- **Gaussian Noise Integration**: Probabilistic noise ensures encryption remains non-deterministic.
- **Shamir's Secret Sharing**: Threshold-based splitting ensures secure key distribution.
- **Ring Validation**: Verifiable integrity using modular arithmetic.
- **PMPT-HMAC**: Probabilistic and verifiable signature generation and verification.

---

## **Project Structure**
```
pmpt/
3-- src/
3   CDD main.rs            # Entry point
3   CDD prime_shamir.rs    # Shamir Secret Sharing and Prime Shares
3-- proof.md               # Mathematical proof of PMPT soundness
3-- README.md              # Project documentation (you are here!)
3-- Cargo.toml             # Project dependencies and configuration
```

---

## **How PMPT Works**

1. **Shamir's Secret Sharing (PSSS):**
   - Secrets are split into prime shares using a polynomial-based threshold scheme.

2. **3D SpherePoint Mapping:**
   - Plaintext is mapped into 3D quadratic space:
     ```markdown 
     SpherePoint = (x, y, z)
     ```
3. **Dynamic Transformations:**
   - Secure S-Box substitutions and Gaussian noise are applied to obfuscate coordinates probabilistically.

4. **Ring Metadata Validation:**
   - A modular quadratic relationship between public and private points verifies encryption integrity:
     ```markdown
     R = (A_x B_x + A_y B_y + A_z B_z) \pmod{N}
     ```
5. **PMPT-HMAC for Signatures:**
   - Probabilistic noise and private keys generate signatures that are verifiable yet unique for every input.

6. **Encryption and Decryption:**
   - Encrypted ciphertexts are probabilistically transformed, ensuring forward security.

---

## **Build and Run**

### **Requirements**
- Rust (latest version)
- Dependencies:
  - `num-bigint`, `rand`, `rand_distr`, `sha3`, `thiserror`, and `rand_chacha`

### **Setup**
1. Clone the repository:
   ```bash
   git clone https://github.com/yourusername/pmpt.git
   cd pmpt
   ```

2. Build the project:
   ```bash
   cargo build --release
   ```

3. Run the project:
   ```bash
   cargo run
   ```

---

## **Example Output**

```plaintext
N: 3650932663730066052170398243157670637252348405796271295645378844395656449904115979013064922230105491238947576914024504343268098314141155727383607424766441
Padding Length: 128 bytes
Share at x = 1 is prime.
Share at x = 2 is prime.
Share at x = 3 is prime.
Share at x = 4 is prime.
Share at x = 5 is prime.
Share at x = 6 is prime.
Private Point: SpherePoint { x: 39023766728371541970201944041460574758395339616523656627206557679880332004570867544242641428034220829282628347471669914705356599966519387652272966867710123645332742740641139265792996345515468663853557180020802523752477839546253671059870952571022757895532286419357931634814117510772564089173378108432014169591, y: 113673372250205193710078376873893816882940036023327356041012025438883155293152870609699770714247503032740941280408145975313701194192982473718334695650764206693049716044776837949493565348436446516512600339749950198766264951180939331925913223270337585838119843234071664610393159839407890499977568878691055186417, z: 101489104776694804620284432997841055827688142592649804737693540079014027175561696027093281433522783079441129448634961125720710718925876444742472010915410841095150564763177081335151276519704879260240098892223466197626812165297404580163196170711866103068665151197169656755954267294076044701956794340720329140901 }
Public Point: SpherePoint { x: 2470964307840374700820112413302291592639659324491002717251101600272947651797343796423173585860060969383192852152115365926385174165201300724684912661650026851635288895841869422766129859320766895036052837441350520334119481895649415771719794895608309587168210308651908071497439874777026695111054494519836034789, y: 61538374421254205150375146119194865269686479474373536987130436398648802102228440256245660021493463764434750191308542808139370687417982668576399751756984587360369926201363335985035472660741492521071334941874148112474974031501878451853303404723565427122806536957615330947597083501367333822663360047418013216709, z: 33771911539323994770259803116601435766936709786774820539885818078152705146486359068004527890188864402728182765755309340151021131177194921386190177333911699223488438921149347249261957630509673038175072439051314028462588683589887075306127691293736233946402614754963012993678792253990468741390700292086423337971 }
Ring metadata validation successful (key generation step).
Signing data: "Example data for PMPT-HMAC"
Generated Signature: SpherePoint { x: 28544917232930824818301226741967047071581033848291672750609816484492822035022668537390143682872960377022300528954318741061565259897783596487592383817763386207489322011925487132624429267427586197914146788707484261931953942862506124263094734015114545224435830008865150408695945709152073949259176425817662423295, y: 5475408982729300665893776657142560523587910543044503623013480008636750210472371707916610539799644458553072596267757571569269737788240701194441414167166831400918687415213997126285498931414611850051696010035870221974271427166936871479379693056315513790141177330346597512083522799943399823915018224781951232, z: 179766581097753820630425583121233502875765971892780059430065955592749961565296731903044454060325175743756463308330888714692003910496362742262996950578132223035469892858570974946489848885500095119424047382650995649382588186599064980073352804343303274965853119823679168732638692691228523956619210659575676076034 }
Verification Result: true
Original Plaintext: Hello, Cryptography!
Mapped Plaintext to SpherePoint: SpherePoint { x: 50838330451376011277063806614632952874050377121800556044588274350982363821075860522326682780618896419769563558713148345811158570454210626697313459997095649987029521453277744147879305319653322474742401366667624317292093003458537658594633173113576564855001722796839783183916088632852588336376042427327746932736, y: 0, z: 0 }
Substituted and Obfuscated SpherePoint: SpherePoint { x: 88104387873780441362614530402672294779527931405916185011438431740939764610484669948508585317582603290894257956259316021347177239736355865217708621436846067856059514687312442678078405539097140894906955186283801518524205855703660179357488891109376525962530229679821400296817824996417732207089441752150492250367, y: 5475408982729300665893776657142560523587910543044503623013480008636750210472371707916610539799644458553072596267757571569269737788240701194441414167166831400918687415213997126285498931414611850051696010035870221974271427166936871479379693056315513790141177330346597512083522799943399823915018224781951232, z: 179766581097753820630425583121233502875765971892780059430065955592749961565296731903044454060325175743756463308330888714692003910496362742262996950578132223035469892858570974946489848885500095119424047382650995649382588186599064980073352804343303274965853119823679168732638692691228523956619210659575676076034 }
Ciphertext: Ciphertext { r: 14781953805462725751585585481615225559582139095430410120107089491188591135600585646229055142986408429115680991773487092338120466743677115870305367865213520286540932090185492648618790400297090105742978507875442195143381441896885662819796026172540200049158349606395851881134524282724117031945236396336498602769, x_s: 88104387873780441362614530402672294779527931405916185011438431740939764610484669948508585317582603290894257956259316021347177239736355865217708621436846067856059514687312442678078405539097140894906955186283801518524205855703660179357488891109376525962530229679821400296817824996417732207089441752150492250367, y_s: 5475408982729300665893776657142560523587910543044503623013480008636750210472371707916610539799644458553072596267757571569269737788240701194441414167166831400918687415213997126285498931414611850051696010035870221974271427166936871479379693056315513790141177330346597512083522799943399823915018224781951232, z_s: 179766581097753820630425583121233502875765971892780059430065955592749961565296731903044454060325175743756463308330888714692003910496362742262996950578132223035469892858570974946489848885500095119424047382650995649382588186599064980073352804343303274965853119823679168732638692691228523956619210659575676076034 }
Ring metadata validation successful (encryption step).
Ring metadata validation successful.
Decrypted SpherePoint after inverse substitution: SpherePoint { x: 50838330451376011277063806614632952874050377121800556044588274350982363821075860522326682780618896419769563558713148345811158570454210626697313459997095649987029521453277744147879305319653322474742401366667624317292093003458537658594633173113576564855001722796839783183916088632852588336376042427327746932736, y: 0, z: 0 }
Reconstructed Plaintext.
Decrypted Plaintext: Hello, Cryptography!
Encryption and decryption are consistent.
```

---

## **Mathematical Proof**
The mathematical soundness of PMPT, including its modular arithmetic, secret sharing, and probabilistic transformations, is detailed in [proof.md](proof.md).

---

## **Security Guarantees**
- **Confidentiality**: Without the private SpherePoint, decryption is infeasible even with knowledge of ```\( N \)```.
- **Integrity**: Ring Metadata ensures ciphertext and signature validation.
- **Forward Security**: Probabilistic noise obfuscation ensures ciphertext uniqueness.
- **Resilience to Cryptanalysis**: Modular arithmetic and 3D transformations create a fundamentally new cryptographic structure.

---

## **Applications**
- Secure encryption and decryption for critical systems.
- Key splitting and threshold security using PSSS.
- Verifiable probabilistic signatures with PMPT-HMAC.
- Post-Quantum resilience due to 3D modular transformations.

---

## **Contributing**
We welcome contributions! Feel free to open issues, submit pull requests, or discuss improvements.

---

## **License**
This project is licensed under the **MIT License**.

---

## **Acknowledgments**
Inspired by neural network transformations and advanced cryptographic primitives. This project combines research, innovation, and practical security solutions.

